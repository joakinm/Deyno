set language  'español'; select vnro,fecha,nombre + ' ' + apellido as Nombre, ('F. ' + cast(NroArmado AS varchar (15))) as movimiento,vtipo as tipo,importe AS Neto_Grabado,(importe * 0.21) AS IVA ,'0' as No_grabado from venta v inner join cliente c on c.Nro_Cl = v.CL where (espedido is null or espedido = 0) and fecha >='05/07/2014' and fecha <='05/08/2014 0:00:00' and vnro not in (select ventanrofac from cuotas)
union
select vnro, c.fecha, nombre + ' ' + apellido as Nombre, ('Cuota de F. ' + cast(NroArmado AS varchar (15))) as movimiento, vtipo as tipo, c.cobrado as Neto_Grabado, (c.cobrado * 0.21) as IVA, '0' as No_grabado from cuotas c inner join Venta v on v.vnro = c.ventanrofac inner join Cliente cl on cl.Nro_Cl = v.CL where c.fecha >='05/07/2014' and c.fecha <='05/08/2014 0:00:00' and c.observacion = 'saldada'

select * from cuotas

set language  'español'; select vnro,fecha,nombre + ' ' + apellido as Nombre, ('F. ' + cast(NroArmado AS varchar (15))) as movimiento,vtipo as tipo,importe AS Neto_Grabado,(importe * 0.21) AS IVA ,'0' as No_grabado from venta v inner join cliente c on c.Nro_Cl = v.CL where (espedido is null or espedido = 0) and fecha >='05/07/2014' and fecha <='05/08/2014 0:00:00'union select vnro, c.fecha, nombre + ' ' + apellido as Nombre, ('Cuota de F. ' + cast(NroArmado AS varchar (15))) as movimiento, vtipo as tipo, c.cobrado as Neto_Grabado, (c.cobrado * 0.21) as IVA, '0' as No_grabado from cuotas c inner join Venta v on v.vnro = c.ventanrofac inner join Cliente cl on cl.Nro_Cl = v.CL where c.fecha >='05/07/2014' and c.fecha <='05/08/2014 0:00:00'and c.observacion = 'saldada'